# Client Webinar Action Consumer (MVP)

## Назначение и границы
Плагин потребляет **только** допустимые сценарные действия клиентского вебинара и фиксирует минимальное состояние маршрута и экрана. Взаимодействие — исключительно через hooks/filters, без UI, уведомлений или таймеров.

## Область ответственности (scope)
- Подписка на действия сценария `route_state` и `screen_transition`.
- Идемпотентная обработка сценарных действий.
- Минимальная фиксация клиентского маршрута и экрана.
- Экспорт состояния только через hooks/filters.

## Не‑цели (non-goals)
- Любая UI‑логика или страницы админки.
- Любые уведомления (Telegram, email и т.п.).
- Любая временная логика, таймеры или cron.
- Партнёрская логика или продажи.
- Прямые зависимости от других плагинов.
- Интерпретация событий — только обработка уже сформированного действия.

## Hooks/Filters
### Входные действия
- `client_webinar_scenario_action_route_state`
- `client_webinar_scenario_action_screen_transition`
- `client_webinar_scenario_action_screen_selection` (алиас)

### Выходные hooks
- `client_webinar_route_state_updated` — обновлён маршрут.
- `client_webinar_route_screen_updated` — обновлён экран.

### Фильтры
- `client_webinar_action_consumer_identity` — переопределение клиентского идентификатора.
- `client_webinar_route_state` — доступ к сохранённому состоянию маршрута.
- `client_webinar_route_screen` — доступ к сохранённому экрану.

## Идемпотентность
Повторное получение одного и того же действия не вызывает повторной записи: используется постоянный опциональный маркер по хэшу действия и контекста без истечения срока хранения.

## Соответствие архитектурным документам
| Код/раздел | Документ | Назначение |
| --- | --- | --- |
| Подписки на `route_state` и `screen_transition` | `CLIENT_WEBINAR_ACTION_CONSUMERS.md` | Допустимые действия и границы потребителя. |
| Ограничение функциональности, отсутствие UI/таймеров/уведомлений | `CLIENT_WEBINAR_ACTION_CONSUMERS.md` | Явные исключения. |
| Идемпотентность обработки | `CLIENT_WEBINAR_SCENARIO_SERVICE.md` | Гарантии уровня сценариев. |
| Использование hooks/filters | `ARCHITECTURE.md` | Принцип взаимодействия модулей через hooks. |
| Допустимые действия сценария | `CLIENT_WEBINAR_SCENARIOS.md` | Перечень разрешённых действий. |
