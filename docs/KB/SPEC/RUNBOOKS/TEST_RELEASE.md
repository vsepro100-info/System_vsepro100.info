Status: SPEC
Owner: Architect
Last updated: 2026-01-28

# Runbook проверки релиза

## Минимальный чек‑лист тестирования

### REST
- [ ] Проверка ключевых эндпоинтов по перечню задачи.
- [ ] Проверка кодов ответов и сообщений об ошибках.

### Роли
- [ ] Роль «гость»: доступ только к публичным страницам.
- [ ] Роль «пользователь»: доступ к личным разделам.
- [ ] Роль «администратор»: доступ к административным страницам.

### Страницы
- [ ] Главные пользовательские страницы из [SPEC/WEBINARS/PAGES](../WEBINARS/PAGES.md).
- [ ] Ошибочные сценарии (неверные параметры, пустые данные).

### Панель администратора
- [ ] Проверка критичных настроек, связанных с изменениями.
- [ ] Проверка страниц управления контентом, если затронуты.

### Инкогнито
- [ ] Открыть ключевые страницы в режиме инкогнито.
- [ ] Проверить отсутствие утечки персональных данных.

## Минимальная end‑to‑end проверка клиентского вебинара (без UI)

### Цель
Зафиксировать минимальную проверку, которая возможна на текущей реализации, и явно отметить, какие шаги остаются запланированными.

### Состояние реализации
- Реально доступен только raw‑сигнал от `client-webinar-tracker-v2` и каноническое событие `client_webinar_completed`.
- Сценарный слой и потребители маршрутизации для вебинаров — запланированы / не реализованы.

### Минимальная цепочка проверки (фактически возможная)
1) **Raw‑сигнал (источник + hook):** источник `client-webinar-tracker-v2`; допустимый hook `do_action("client_webinar_completed")` как факт завершения.
2) **Каноническое событие:** `client_webinar_completed` фиксируется как канонический факт завершения.

### Запланированная цепочка проверки (ещё не реализовано)
1) **Сценарное действие:** Scenario Service должен эмитить действие «маршрутизация клиента между допустимыми состояниями сценария» как реакцию на `client_webinar_completed`.
2) **Обновление состояния потребителя:** Consumer маршрута клиента должен обновить состояние маршрута (зафиксировать новое допустимое состояние/шаг клиента).

### Ограничения
- Только фактологическая проверка цепочки: raw‑сигнал → каноническое событие → сценарное действие → состояние потребителя.
- Никаких UI, тест‑харнесов, моков, новых hook’ов или реализации.
- Никаких побочных эффектов (уведомлений, расписаний, партнёрской логики, продаж).

## Известные проблемы

### Шаблон записи
```
Проблема:
Симптомы:
Быстрая проверка:
Решение:
Связанные страницы/модули:
```

### Записи
- **WP login/admin редиректы/защита ломают доступ**
  - Симптомы: `/wp-login` не редиректит или редиректит странно; `/wp-admin` не пускает.
  - Быстрая проверка: правила редиректов, ограничения доступа, активные защитные настройки, прокси/фильтры.
  - Решение: отключить/скорректировать защиту и правила редиректа, сверить разрешённые пути.
- **GET `/wp-json/.../state` возвращает `404 no_webinar`**
  - Симптомы: запрос состояния события возвращает 404 с `no_webinar`.
  - Быстрая проверка: есть ли активное событие.
  - Решение: это допустимо при отсутствии активного события и не является ошибкой (важно для консоли).

Связанные документы:
- [SPEC/WEBINARS/FLOWS](../WEBINARS/FLOWS.md)
- [CANON/PRINCIPLES](../../CANON/PRINCIPLES.md)
